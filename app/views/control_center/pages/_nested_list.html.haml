- if root && page.level == 0
  - children = [page]
- else
  - children = ControlCenter::Page.where(:parent_id => page.id).asc(:position)
%ul{:class => children.first.level == 0 && "pages", :data => {:level => children.first.level}}
  - for child in children
    %li{:data => {:id => "page-#{child.id}"}}
      %p
        %span.handle
        = link_to child.title, edit_control_center_page_path(child), :class => "title"
        = link_to "Add", new_control_center_page_path(:level => child.level + 1, :parent_id => child.id), :class => "link-button hidden"
        = link_to "Delete", control_center_page_path(child), :method => :delete, :confirm => "Are you sure?", :class => "link-button hidden"
      - if ControlCenter::Page.where(:parent_id => child.id).count > 0
        = render :partial => "nested_list", :locals => {:page => child, :root => false}